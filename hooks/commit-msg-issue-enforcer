#!/bin/sh
#
# Check that the commit message contains a reference to a GitHub issue.
# The pattern checked is "(ref #123)" or just "#123" depending on strictness.
#

COMMIT_MSG_FILE=$1
COMMIT_MSG=$(cat "$COMMIT_MSG_FILE")

# Pattern: matches #<number>
# Examples: "feat: add login #123", "fix: bug (ref #42)"
PATTERN="#[0-9]+"

if ! echo "$COMMIT_MSG" | grep -qE "$PATTERN"; then
  echo "‚ùå ABORT COMMIT: No Issue Reference Found."
  echo "------------------------------------------------"
  echo "Every commit must reference a GitHub Issue."
  echo "Please add '#<issue-id>' to your commit message."
  echo "Example: 'feat: add login page #42'"
  echo "------------------------------------------------"
  exit 1
fi

exit 0
